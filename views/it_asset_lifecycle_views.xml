<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue cycle de vie des équipements -->
    <record id="view_it_asset_lifecycle_form" model="ir.ui.view">
        <field name="name">it.asset.lifecycle.form</field>
        <field name="model">it.asset</field>
        <field name="inherit_id" ref="it_parc.view_it_asset_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Cycle de vie" name="lifecycle">
                    <group>
                        <group string="Dates clés">
                            <field name="purchase_date"/>
                            <field name="commissioning_date"/>
                            <field name="warranty_end"/>
                            <field name="recommended_renewal_date"/>
                            <field name="end_of_life_date"/>
                        </group>
                        <group string="État de santé">
                            <field name="health_score" widget="percentpie"/>
                            <field name="renewal_priority"/>
                            <field name="cpu_health"/>
                            <field name="ram_health"/>
                            <field name="disk_health"/>
                            <field name="battery_health"/>
                        </group>
                    </group>
                    <group>
                        <group string="Analyse financière">
                            <field name="purchase_value"/>
                            <field name="current_value"/>
                            <field name="lifecycle_cost"/>
                            <field name="cost_per_month"/>
                            <field name="depreciation_percentage" widget="percentage"/>
                        </group>
                        <group string="Métriques de performance">
                            <field name="incident_count"/>
                            <field name="mttf" widget="float_time"/>
                            <field name="mttr" widget="float_time"/>
                            <field name="age_in_months"/>
                        </group>
                    </group>
                    
                    <group string="Timeline du cycle de vie">
                        <field name="lifecycle_timeline" widget="timeline" 
                               options="{'min_height': 200, 'hide_unavailable_data': true}"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
    
    <!-- Rapport de cycle de vie -->
    <record id="action_it_asset_lifecycle_report" model="ir.actions.act_window">
        <field name="name">Analyse du cycle de vie</field>
        <field name="res_model">it.asset</field>
        <field name="view_mode">graph,pivot,list,form</field>
        <field name="context">{'search_default_group_by_renewal_priority': 1}</field>
    </record>
    
    
    <!-- Créer d'abord le menu parent pour les rapports -->
    <menuitem id="menu_it_asset_reporting"
              name="Rapports"
              parent="menu_it_asset"
              sequence="100"/>
              
    <!-- Menu pour l'analyse du cycle de vie -->
    <menuitem id="menu_it_asset_lifecycle_report"
              name="Analyse du cycle de vie"
              parent="menu_it_asset_reporting"
              action="action_it_asset_lifecycle_report"
              sequence="20"/>
</odoo>